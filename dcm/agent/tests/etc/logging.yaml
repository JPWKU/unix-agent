---
version: 1
disable_existing_loggers: False
formatters:
    simple:
        format: "%(levelname)s - %(message)s"
    job:
        format: "%(levelname)s - %(job_id) - %(message)s"
    message:
        format: "%(levelname)s REQUEST=%(request_id)s COMMAND=%(command_name)s -- %(message)s"


handlers:
    console:
        class: logging.StreamHandler
        level: DEBUG
        formatter: simple
        stream: ext://sys.stdout

    file_handler:
        class: logging.handlers.RotatingFileHandler
        level: DEBUG
        formatter: simple
        filename: /tmp/agent.log
        maxBytes: 10485760
        backupCount: 20
        encoding: utf8

    job_file_handler:
        class: dcm.agent.util.JobLogHandler
        level: DEBUG
        formatter: simple
        encoding: utf8
        filename_format: "/tmp/%(logname)s-%(job_id)s.log"

    state_handler:
        class: logging.StreamHandler
        level: DEBUG
        formatter: message
        stream: ext://sys.stdout

    message_logger:
        class: logging.StreamHandler
        level: DEBUG
        formatter: message
        stream: ext://sys.stdout

loggers:
    dcm.agent:
        level: DEBUG
        handlers: [console]
        propagate: no

    dcm.agent.jobs:
        level: DEBUG
        handlers: [job_file_handler]
        propagate: no

    dcm.agent.messaging.states:
        level: DEBUG
        handlers: [state_handler]
        propagate: no

    dcm.agent.dispatcher:
        level: DEBUG
        handlers: [message_logger]
        propagate: no

root:
    level: DEBUG
    handlers: [console]
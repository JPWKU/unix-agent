Vagrant.configure("2") do |config|

  config.vm.define 'ubuntu-11.04' do |c|
    c.berkshelf.berksfile_path = "./Berksfile"
    c.vm.box = "opscode-ubuntu-11.04"
    c.vm.box_url = "http://opscode-vm.s3.amazonaws.com/vagrant/boxes/opscode-ubuntu-11.04.box"
    c.vm.provision :shell do |shell|
      shell.inline = "/vagrant/test-distro.sh $1"
      shell.args = "dcm-agent_amd64.deb"
    end
  end

  config.vm.define 'ubuntu-12.04' do |c|
    c.berkshelf.berksfile_path = "./Berksfile"
    c.vm.box = "canonical-ubuntu-12.04"
    c.vm.box_url = "http://cloud-images.ubuntu.com/vagrant/precise/current/precise-server-cloudimg-amd64-vagrant-disk1.box"
    c.vm.provision :shell do |shell|
      shell.inline = "/vagrant/test-distro.sh $1"
      shell.args = "dcm-agent_amd64.deb"
    end
  end

  config.vm.define 'ubuntu-14.04' do |c|
    c.berkshelf.berksfile_path = "./Berksfile"
    c.vm.box = "canonical-ubuntu-14.04"
    c.vm.box_url = "http://cloud-images.ubuntu.com/vagrant/trusty/current/trusty-server-cloudimg-amd64-vagrant-disk1.box"
    c.vm.provision :shell do |shell|
      shell.inline = "/vagrant/test-distro.sh $1"
      shell.args = "dcm-agent_amd64.deb"
    end
  end

  config.vm.define 'ubuntu-14.04.386' do |c|
    c.berkshelf.berksfile_path = "./Berksfile"
    c.vm.box = "canonical-ubuntu-14.04.386"
    c.vm.box_url = "http://cloud-images.ubuntu.com/vagrant/trusty/current/trusty-server-cloudimg-i386-vagrant-disk1.box"
    c.vm.provision :shell do |shell|
      shell.inline = "/vagrant/test-distro.sh $1"
      shell.args = "dcm-agent_386.deb"
    end
  end

  config.vm.define 'centos-6' do |c|
    c.berkshelf.berksfile_path = "./Berksfile"
    c.vm.box = "opscode-centos-6.3"
    c.vm.box_url = "http://opscode-vm.s3.amazonaws.com/vagrant/opscode_centos-6.3_chef-11.2.0.box"
  end

  config.vm.network :private_network, ip: "172.16.129.50"
  config.vm.provider "virtualbox" do |v|
    v.customize [ "createhd", "--filename", "/tmp/disk", "--size", 1000 ]
    v.customize ['storageattach', :id, '--storagectl', 'SATAController', '--port', 1, '--device', 0, '--type', 'hdd', '--medium', "/tmp/disk.vdi"]
    v.memory = 1024
  end

  config.vm.synced_folder "../omnibus-dcm-agent/pkg/", "/agent/pkgs"
  config.vm.synced_folder "../src/", "/agent/src"
  vagrant_root = File.dirname(__FILE__)
  vagrant_root = File.dirname(vagrant_root)
  config.vm.synced_folder "../", vagrant_root

end

Environment variables for container build
-----------------------------------------

In order for the docker file to be properly build the file ./env.sh must be
populated with the following mandatory envs.  The optional envs may be set
as well.

- AGENT_BASE_URL (Mandatory)
  The web repository from which the agent packages will be fetched.

- DCM_AGENT_CLOUD (Default Konami)
  This is the cloud on which the agent will be told that it is running.  For
  now only Konami is supported.


All environment variables in the script found at:
https://s3.amazonaws.com/dcmagentunstable/installer.sh can optionally be set.


Environment variables for container start
-----------------------------------------

- DCM_AGENT_URL (No default, mandatory)
  This is the websocket url of the agent manager that the agent

- DCM_KONAMI_INSTANCE_ID (No default, mandatory)
  This is the instance ID of the fake server that the agent is told it is
  running in.

- DCM_AGENT_PRE_START_SLEEP (Default 0)
  The number of seconds to sleep before starting the agent.  Good for testing
  various timings.

- DCM_AGENT_SSH_KEY (Default is John Bresnahan's)
  The ssh key to be injected into the container for root level access.

Building
--------

# docker build -t dcmagent4 .

Running
-------

A very basic test can be done by running netcat on your local system and then
running the agent image in docker and pointing it at that port.  If the
connection happens we have a small warm fuzzy:

Run net cat such that it is listening on a port:
# nc -l 16433

Run the agent image so that it connects to that port (assume local IP is
192.168.1.54)

# docker run -e DCM_AGENT_URL=wss://192.168.1.54:16433 -e DCM_AGENT_CLOUD=Amazon -P dcmagent9 /sbin/my_init

After running this you should see binary data on stdout of the nc session.

